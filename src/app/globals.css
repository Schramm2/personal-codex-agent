@import "tailwindcss";
@import "tw-animate-css";

@custom-variant dark (&:is(.dark *));

@theme inline {
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --font-sans: var(--font-geist-sans);
  --font-mono: var(--font-geist-mono);
  --color-sidebar-ring: var(--sidebar-ring);
  --color-sidebar-border: var(--sidebar-border);
  --color-sidebar-accent-foreground: var(--sidebar-accent-foreground);
  --color-sidebar-accent: var(--sidebar-accent);
  --color-sidebar-primary-foreground: var(--sidebar-primary-foreground);
  --color-sidebar-primary: var(--sidebar-primary);
  --color-sidebar-foreground: var(--sidebar-foreground);
  --color-sidebar: var(--sidebar);
  --color-chart-5: var(--chart-5);
  --color-chart-4: var(--chart-4);
  --color-chart-3: var(--chart-3);
  --color-chart-2: var(--chart-2);
  --color-chart-1: var(--chart-1);
  --color-ring: var(--ring);
  --color-input: var(--input);
  --color-border: var(--border);
  --color-destructive: var(--destructive);
  --color-accent-foreground: var(--accent-foreground);
  --color-accent: var(--accent);
  --color-muted-foreground: var(--muted-foreground);
  --color-muted: var(--muted);
  --color-secondary-foreground: var(--secondary-foreground);
  --color-secondary: var(--secondary);
  --color-primary-foreground: var(--primary-foreground);
  --color-primary: var(--primary);
  --color-popover-foreground: var(--popover-foreground);
  --color-popover: var(--popover);
  --color-card-foreground: var(--card-foreground);
  --color-card: var(--card);
  --radius-sm: calc(var(--radius) - 4px);
  --radius-md: calc(var(--radius) - 2px);
  --radius-lg: var(--radius);
  --radius-xl: calc(var(--radius) + 4px);
}

:root {
  --radius: 0.625rem;
  --background: oklch(1 0 0);
  --foreground: oklch(0.145 0 0);
  --card: oklch(1 0 0);
  --card-foreground: oklch(0.145 0 0);
  --popover: oklch(1 0 0);
  --popover-foreground: oklch(0.145 0 0);
  --primary: oklch(0.205 0 0);
  --primary-foreground: oklch(0.985 0 0);
  --secondary: oklch(0.97 0 0);
  --secondary-foreground: oklch(0.205 0 0);
  --muted: oklch(0.97 0 0);
  --muted-foreground: oklch(0.556 0 0);
  --accent: oklch(0.97 0 0);
  --accent-foreground: oklch(0.205 0 0);
  --destructive: oklch(0.577 0.245 27.325);
  --border: oklch(0.922 0 0);
  --input: oklch(0.922 0 0);
  --ring: oklch(0.708 0 0);
  --chart-1: oklch(0.646 0.222 41.116);
  --chart-2: oklch(0.6 0.118 184.704);
  --chart-3: oklch(0.398 0.07 227.392);
  --chart-4: oklch(0.828 0.189 84.429);
  --chart-5: oklch(0.769 0.188 70.08);
  --sidebar: oklch(0.985 0 0);
  --sidebar-foreground: oklch(0.145 0 0);
  --sidebar-primary: oklch(0.205 0 0);
  --sidebar-primary-foreground: oklch(0.985 0 0);
  --sidebar-accent: oklch(0.97 0 0);
  --sidebar-accent-foreground: oklch(0.205 0 0);
  --sidebar-border: oklch(0.922 0 0);
  --sidebar-ring: oklch(0.708 0 0);
}

.dark {
  --background: oklch(0.145 0 0);
  --foreground: oklch(0.985 0 0);
  --card: oklch(0.205 0 0);
  --card-foreground: oklch(0.985 0 0);
  --popover: oklch(0.205 0 0);
  --popover-foreground: oklch(0.985 0 0);
  --primary: oklch(0.922 0 0);
  --primary-foreground: oklch(0.205 0 0);
  --secondary: oklch(0.269 0 0);
  --secondary-foreground: oklch(0.985 0 0);
  --muted: oklch(0.269 0 0);
  --muted-foreground: oklch(0.708 0 0);
  --accent: oklch(0.269 0 0);
  --accent-foreground: oklch(0.985 0 0);
  --destructive: oklch(0.704 0.191 22.216);
  --border: oklch(1 0 0 / 10%);
  --input: oklch(1 0 0 / 15%);
  --ring: oklch(0.556 0 0);
  --chart-1: oklch(0.488 0.243 264.376);
  --chart-2: oklch(0.696 0.17 162.48);
  --chart-3: oklch(0.769 0.188 70.08);
  --chart-4: oklch(0.627 0.265 303.9);
  --chart-5: oklch(0.645 0.246 16.439);
  --sidebar: oklch(0.205 0 0);
  --sidebar-foreground: oklch(0.985 0 0);
  --sidebar-primary: oklch(0.488 0.243 264.376);
  --sidebar-primary-foreground: oklch(0.985 0 0);
  --sidebar-accent: oklch(0.269 0 0);
  --sidebar-accent-foreground: oklch(0.985 0 0);
  --sidebar-border: oklch(1 0 0 / 10%);
  --sidebar-ring: oklch(0.556 0 0);
}

@layer base {
  * {
    @apply border-border outline-ring/50;
  }
  body {
    @apply bg-background text-foreground;
  }
}

@layer utilities {
  /* Custom animations */
  .animate-in {
    animation: animateIn 0.2s ease-out;
  }
  
  .slide-in-from-bottom-2 {
    animation: slideInFromBottom 0.2s ease-out;
  }
  
  .fade-in {
    animation: fadeIn 0.2s ease-out;
  }
  
  .scale-in {
    animation: scaleIn 0.2s ease-out;
  }
  
  /* Message bubble animations */
  .message-enter {
    animation: messageEnter 0.3s ease-out;
  }
  
  .message-exit {
    animation: messageExit 0.2s ease-in;
  }
  
  /* Streaming indicator animations */
  .typing-dot {
    animation: typingDot 1.4s infinite ease-in-out;
  }
  
  .typing-dot:nth-child(1) { animation-delay: -0.32s; }
  .typing-dot:nth-child(2) { animation-delay: -0.16s; }
  .typing-dot:nth-child(3) { animation-delay: 0s; }
}

@keyframes animateIn {
  from {
    opacity: 0;
    transform: scale(0.95);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}

@keyframes slideInFromBottom {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

@keyframes scaleIn {
  from {
    opacity: 0;
    transform: scale(0.9);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}

@keyframes messageEnter {
  from {
    opacity: 0;
    transform: translateY(20px) scale(0.95);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

@keyframes messageExit {
  from {
    opacity: 1;
    transform: scale(1);
  }
  to {
    opacity: 0;
    transform: scale(0.95);
  }
}

@keyframes typingDot {
  0%, 80%, 100% {
    transform: scale(0.8);
    opacity: 0.5;
  }
  40% {
    transform: scale(1);
    opacity: 1;
  }
}

/* Focus ring improvements */
.focus-visible\:ring-ring:focus-visible {
  box-shadow: 0 0 0 2px hsl(var(--ring));
}

/* Header-specific mobile optimizations */
@media (max-width: 640px) {
  /* Ensure header fits properly on small mobile screens */
  header {
    min-height: 48px; /* 3rem - matches h-12 */
  }
  
  /* Better mobile header spacing */
  header .container {
    padding-left: 0.5rem; /* 8px */
    padding-right: 0.5rem; /* 8px */
  }
  
  /* Mobile header button sizing */
  header button {
    min-height: 28px; /* 7 * 4px = 28px */
    min-width: 28px;
  }
  
  /* Mobile header text sizing */
  header h1 {
    font-size: 0.875rem; /* 14px */
    line-height: 1.25rem; /* 20px */
  }
  
  header p {
    font-size: 0.75rem; /* 12px */
    line-height: 1rem; /* 16px */
  }
  
  /* Mobile header icon sizing */
  header svg {
    width: 14px; /* 3.5 * 4px = 14px */
    height: 14px;
  }
  
  /* Mobile header gaps */
  header .flex > div:first-child {
    gap: 0.375rem; /* 6px */
  }
  
  header .flex > div:last-child {
    gap: 0.125rem; /* 2px */
  }
  
  /* Ensure text doesn't overflow on small screens */
  header .min-w-0 {
    overflow: hidden;
  }
  
  header .truncate {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }
  
  /* Better mobile touch targets */
  header button,
  header a {
    touch-action: manipulation;
    -webkit-tap-highlight-color: transparent;
  }
  
  /* Mobile header container improvements */
  header .container {
    max-width: 100%;
    margin: 0 auto;
  }
}

/* Small mobile screens (iPhone SE, etc.) */
@media (max-width: 375px) {
  header .container {
    padding-left: 0.375rem; /* 6px */
    padding-right: 0.375rem; /* 6px */
  }
  
  header h1 {
    font-size: 0.8125rem; /* 13px */
  }
  
  header p {
    font-size: 0.6875rem; /* 11px */
  }
  
  /* Reduce gaps further for very small screens */
  header .flex > div:first-child {
    gap: 0.25rem; /* 4px */
  }
  
  header .flex > div:last-child {
    gap: 0.125rem; /* 2px */
  }
  
  /* Ensure proper text sizing on very small screens */
  header .min-w-0 {
    max-width: 120px; /* Limit width to prevent overflow */
  }
}

/* Extra small mobile screens */
@media (max-width: 320px) {
  header .container {
    padding-left: 0.25rem; /* 4px */
    padding-right: 0.25rem; /* 4px */
  }
  
  header h1 {
    font-size: 0.75rem; /* 12px */
  }
  
  header p {
    font-size: 0.625rem; /* 10px */
  }
  
  /* Minimal gaps for very small screens */
  header .flex > div:first-child {
    gap: 0.125rem; /* 2px */
  }
  
  header .flex > div:last-child {
    gap: 0.0625rem; /* 1px */
  }
  
  /* Ensure text fits on very small screens */
  header .min-w-0 {
    max-width: 100px;
  }
  
  /* Reduce button sizes for very small screens */
  header button {
    min-height: 24px;
    min-width: 24px;
  }
  
  header svg {
    width: 12px;
    height: 12px;
  }
}

/* iPhone 12 specific optimizations (390px width) */
@media (min-width: 375px) and (max-width: 390px) {
  header .container {
    padding-left: 0.5rem; /* 8px */
    padding-right: 0.5rem; /* 8px */
  }
  
  header h1 {
    font-size: 0.875rem; /* 14px */
  }
  
  header p {
    font-size: 0.75rem; /* 12px */
  }
  
  /* iPhone 12 specific spacing */
  header .flex > div:first-child {
    gap: 0.375rem; /* 6px */
  }
  
  header .flex > div:last-child {
    gap: 0.125rem; /* 2px */
  }
  
  /* Ensure proper text sizing for iPhone 12 */
  header .min-w-0 {
    max-width: 140px; /* Slightly more space on iPhone 12 */
  }
}

/* Ensure header works well on all mobile orientations */
@media (max-width: 640px) and (orientation: landscape) {
  header {
    min-height: 44px; /* Slightly smaller for landscape */
  }
  
  header .container {
    padding-left: 0.375rem; /* 6px */
    padding-right: 0.375rem; /* 6px */
  }
  
  /* Reduce text size in landscape */
  header h1 {
    font-size: 0.8125rem; /* 13px */
  }
  
  header p {
    font-size: 0.6875rem; /* 11px */
  }
}

/* Mobile optimizations */
@media (max-width: 768px) {
  .message-bubble {
    max-width: 90%;
  }
  
  .composer-input {
    min-height: 44px; /* Better tap target */
  }
  
  .action-button {
    min-height: 44px;
    min-width: 44px;
  }
  
  /* Ensure proper touch scrolling on mobile */
  .chat-messages-container {
    -webkit-overflow-scrolling: touch;
    overscroll-behavior: contain;
  }
}

/* iPad optimizations */
@media (min-width: 769px) and (max-width: 1024px) {
  .message-bubble {
    max-width: 85%;
  }
  
  .chat-messages-container {
    -webkit-overflow-scrolling: touch;
    overscroll-behavior: contain;
  }
}

/* Smooth scrolling */
html {
  scroll-behavior: smooth;
}

/* Chat window height and scroll behavior */
.chat-messages-container {
  height: 1000px;
  max-height: 1000px;
  overflow: hidden;
  min-height: 0;
  flex-shrink: 0;
  display: flex;
  flex-direction: column;
}

/* Responsive height adjustments */
@media (max-width: 1024px) {
  .chat-messages-container {
    height: 500px;
    max-height: 500px;
  }
}

@media (max-width: 768px) {
  .chat-messages-container {
    height: 400px;
    max-height: 400px;
  }
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 6px;
}

::-webkit-scrollbar-track {
  background: transparent;
}

::-webkit-scrollbar-thumb {
  background: hsl(var(--muted));
  border-radius: 3px;
}

::-webkit-scrollbar-thumb:hover {
  background: hsl(var(--muted-foreground));
}

/* Mobile-specific scrollbar */
@media (max-width: 768px) {
  ::-webkit-scrollbar {
    width: 4px;
  }
  
  ::-webkit-scrollbar-thumb {
    background: hsl(var(--muted) / 0.6);
  }
}

/* Ensure proper touch behavior on mobile */
* {
  -webkit-tap-highlight-color: transparent;
}

/* Improve mobile input experience */
@media (max-width: 768px) {
  input, textarea {
    font-size: 16px; /* Prevents zoom on iOS */
  }
}

/* Mobile-specific improvements for chat scrolling */
@media (max-width: 768px) {
  .chat-messages-container {
    /* Perfect mobile scrolling */
    -webkit-overflow-scrolling: touch;
    overscroll-behavior: contain;
    overflow-x: hidden;
    /* Fixed height for mobile */
    height: 400px;
    max-height: 400px;
    /* Better mobile performance */
    will-change: scroll-position;
    /* Prevent mobile zoom issues */
    touch-action: pan-y pinch-zoom;
  }
  
  /* Mobile-optimized message layout */
  .message-bubble {
    margin-bottom: 0.75rem;
    /* Better mobile spacing */
    padding: 0.5rem;
  }
  
  /* Mobile button improvements */
  .action-button {
    min-height: 44px;
    min-width: 44px;
    /* Better touch feedback */
    transition: all 0.15s ease;
  }
  
  /* Mobile scrollbar */
  ::-webkit-scrollbar {
    width: 4px;
  }
  
  ::-webkit-scrollbar-thumb {
    background: hsl(var(--muted) / 0.6);
    border-radius: 2px;
  }
  
  /* Mobile input improvements */
  input, textarea {
    font-size: 16px;
    /* Better mobile input experience */
    -webkit-appearance: none;
    border-radius: 0.5rem;
  }
  
  /* Mobile card improvements */
  .card {
    border-radius: 1rem;
  }
  
  /* Mobile spacing improvements */
  .space-y-3 > :not([hidden]) ~ :not([hidden]) {
    margin-top: 0.75rem;
  }
  
  .space-y-4 > :not([hidden]) ~ :not([hidden]) {
    margin-top: 1rem;
  }
  
  .space-y-6 > :not([hidden]) ~ :not([hidden]) {
    margin-top: 1.5rem;
  }
}

/* iPad-specific optimizations */
@media (min-width: 769px) and (max-width: 1024px) {
  .chat-messages-container {
    -webkit-overflow-scrolling: touch;
    overscroll-behavior: contain;
    height: 500px;
    max-height: 500px;
    /* iPad-specific improvements */
    touch-action: pan-y pinch-zoom;
  }
  
  .message-bubble {
    margin-bottom: 1rem;
  }
  
  /* iPad button sizing */
  .action-button {
    min-height: 40px;
    min-width: 40px;
  }
}

/* Ensure proper viewport handling on all devices */
@media (max-width: 1024px) {
  .chat-messages-container {
    height: 500px;
    max-height: 500px;
    /* Better mobile performance */
    will-change: scroll-position;
  }
}

/* Improve touch targets on mobile */
@media (max-width: 768px) {
  button, 
  [role="button"],
  input[type="button"],
  input[type="submit"],
  input[type="reset"] {
    min-height: 44px;
    min-width: 44px;
  }
  
  /* Better mobile spacing */
  .space-y-4 > :not([hidden]) ~ :not([hidden]) {
    margin-top: 1rem;
  }
  
  .space-y-6 > :not([hidden]) ~ :not([hidden]) {
    margin-top: 1.5rem;
  }
}

/* Prevent text selection on mobile for better UX */
@media (max-width: 768px) {
  .message-bubble {
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
  }
  
  /* Allow text selection in message content */
  .message-bubble .prose {
    -webkit-user-select: text;
    -moz-user-select: text;
    -ms-user-select: text;
    user-select: text;
  }
}

/* Final mobile optimizations for perfect responsiveness */
@media (max-width: 768px) {
  /* Ensure proper mobile chat experience */
  .chat-messages-container {
    /* Perfect mobile scrolling */
    -webkit-overflow-scrolling: touch;
    overscroll-behavior: contain;
    overflow-x: hidden;
    /* Mobile-optimized height */
    min-height: calc(100vh - 20rem);
    /* Better mobile performance */
    will-change: scroll-position;
    /* Prevent mobile zoom issues */
    touch-action: pan-y pinch-zoom;
  }
  
  /* Mobile-optimized message layout */
  .message-bubble {
    margin-bottom: 0.75rem;
    /* Better mobile spacing */
    padding: 0.5rem;
  }
  
  /* Mobile button improvements */
  .action-button {
    min-height: 44px;
    min-width: 44px;
    /* Better touch feedback */
    transition: all 0.15s ease;
  }
  
  /* Mobile scrollbar */
  ::-webkit-scrollbar {
    width: 4px;
  }
  
  ::-webkit-scrollbar-thumb {
    background: hsl(var(--muted) / 0.6);
    border-radius: 2px;
  }
  
  /* Mobile input improvements */
  input, textarea {
    font-size: 16px;
    /* Better mobile input experience */
    -webkit-appearance: none;
    border-radius: 0.5rem;
  }
  
  /* Mobile card improvements */
  .card {
    border-radius: 1rem;
  }
  
  /* Mobile spacing improvements */
  .space-y-3 > :not([hidden]) ~ :not([hidden]) {
    margin-top: 0.75rem;
  }
  
  .space-y-4 > :not([hidden]) ~ :not([hidden]) {
    margin-top: 1rem;
  }
  
  .space-y-6 > :not([hidden]) ~ :not([hidden]) {
    margin-top: 1.5rem;
  }
}

/* iPad-specific optimizations */
@media (min-width: 769px) and (max-width: 1024px) {
  .chat-messages-container {
    -webkit-overflow-scrolling: touch;
    overscroll-behavior: contain;
    min-height: calc(100vh - 18rem);
    /* iPad-specific improvements */
    touch-action: pan-y pinch-zoom;
  }
  
  .message-bubble {
    margin-bottom: 1rem;
  }
  
  /* iPad button sizing */
  .action-button {
    min-height: 40px;
    min-width: 40px;
  }
}

/* Ensure proper viewport handling on all devices */
@media (max-width: 1024px) {
  .chat-messages-container {
    height: 100%;
    max-height: 100%;
    min-height: calc(100vh - 16rem);
    /* Better mobile performance */
    will-change: scroll-position;
  }
}

/* Improve touch targets on mobile */
@media (max-width: 768px) {
  button, 
  [role="button"],
  input[type="button"],
  input[type="submit"],
  input[type="reset"] {
    min-height: 44px;
    min-width: 44px;
  }
  
  /* Better mobile spacing */
  .space-y-4 > :not([hidden]) ~ :not([hidden]) {
    margin-top: 1rem;
  }
  
  .space-y-6 > :not([hidden]) ~ :not([hidden]) {
    margin-top: 1.5rem;
  }
}

/* Prevent text selection on mobile for better UX */
@media (max-width: 768px) {
  .message-bubble {
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
  }
  
  /* Allow text selection in message content */
  .message-bubble .prose {
    -webkit-user-select: text;
    -moz-user-select: text;
    -ms-user-select: text;
    user-select: text;
  }
}

/* Mobile-specific performance improvements */
@media (max-width: 768px) {
  /* Optimize animations for mobile */
  .animate-in,
  .slide-in-from-bottom-2,
  .fade-in,
  .scale-in,
  .message-enter,
  .message-exit {
    animation-duration: 0.2s;
  }
  
  /* Better mobile transitions */
  * {
    transition-duration: 0.15s;
  }
  
  /* Mobile-specific hover states */
  @media (hover: none) {
    .hover\:bg-muted:hover {
      background-color: transparent;
    }
    
    .hover\:border-primary\/50:hover {
      border-color: hsl(var(--border));
    }
    
    .hover\:bg-primary\/5:hover {
      background-color: transparent;
    }
  }
}

/* Ensure proper mobile keyboard handling */
@media (max-width: 768px) {
  /* Prevent mobile zoom on input focus */
  input[type="text"],
  input[type="email"],
  input[type="password"],
  input[type="search"],
  input[type="tel"],
  input[type="url"],
  textarea {
    font-size: 16px;
    -webkit-appearance: none;
    border-radius: 0.5rem;
  }
  
  /* Better mobile form handling */
  form {
    /* Prevent mobile form zoom */
    -webkit-text-size-adjust: 100%;
  }
}

/* Additional chat container improvements */
.chat-messages-container {
  /* Ensure proper flex behavior */
  flex: 1 1 auto;
  /* Prevent height issues */
  min-height: 0;
  /* Ensure scrolling works */
  overflow: hidden;
}

/* ScrollArea improvements */
[data-radix-scroll-area-viewport] {
  /* Ensure proper height inheritance */
  height: 100% !important;
  /* Enable smooth scrolling */
  scroll-behavior: smooth;
}

/* Ensure chat content doesn't overflow */
.chat-messages-container > div {
  height: 100%;
  overflow: hidden;
}

/* Responsive height adjustments for main chat container */
@media (max-width: 1024px) {
  .chat-container {
    height: calc(100vh - 10rem) !important;
    min-height: 500px !important;
  }
}

@media (max-width: 768px) {
  .chat-container {
    height: calc(100vh - 8rem) !important;
    min-height: 400px !important;
  }
}

/* Ensure proper mobile height handling */
@media (max-width: 768px) {
  /* Mobile chat container */
  .chat-container {
    height: calc(100vh - 8rem) !important;
    min-height: 400px !important;
  }
  
  /* Mobile chat messages container */
  .chat-messages-container {
    height: 400px !important;
    max-height: 400px !important;
    min-height: 400px !important;
  }
}

/* iPad height handling */
@media (min-width: 769px) and (max-width: 1024px) {
  .chat-container {
    height: calc(100vh - 10rem) !important;
    min-height: 500px !important;
  }
  
  .chat-messages-container {
    height: 500px !important;
    max-height: 500px !important;
    min-height: 500px !important;
  }
}
